<p><span style="font-size: 14px; color: #b5b8a5; line-height: 22px; font-family: Arial;"> </span></p>
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">一、同时关闭所有打开的view&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">在view中,只有一个close,每次只能关闭当前窗口&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">在eclipse的编辑窗口的标题上点右键,里面有 close All&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">可以使用遍历的方法，遍历所有打开的View，然后将其隐藏：&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">AsyncUtil.asyncExec(new Runnable()&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">{&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void run()&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IWorkbenchPage page = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage();&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IViewReference[] iViewReferences = page.getViewReferences();&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (IViewReference iViewReference: iViewReferences)&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!ID.equals(iViewReference.getId()))&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page.hideView(iViewReference);&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">});&nbsp;&nbsp;&nbsp;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp; 二、RCP中产生目标区的Bar&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">产生红线区域的Bar,实现方法如下：<br style="line-height: 22px; padding: 0px; margin: 0px;">1、这个是perspective，要创建多个perspective，然后设置某个为active<br style="line-height: 22px; padding: 0px; margin: 0px;">2、在WorkbenchWindowAdvisor中preWindowOpen内，加下面这段代码<br style="line-height: 22px; padding: 0px; margin: 0px;">public void preWindowOpen() {&nbsp;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPreferenceStore apiStore = PrefUtil.getAPIPreferenceStore();<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apiStore.setValue(IWorkbenchPreferenceConstants.DOCK_PERSPECTIVE_BAR,<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IWorkbenchPreferenceConstants.TOP_RIGHT);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apiStore.setValue(<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IWorkbenchPreferenceConstants.SHOW_TRADITIONAL_STYLE_TABS,<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; false);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;}<br style="line-height: 22px; padding: 0px; margin: 0px;">3、需要加 config.setShowPespectivebar(true);&nbsp;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">三、RCP项目－－窗口关闭事件&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">在ApplicationWorkbenchWindowAdvisor中override&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">public boolean preWindowShellClose() {&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // do nothing, but allow the close() to proceed&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox msgBox = new MessageBox(new Shell(), SWT.YES|SWT.NO|SWT.ICON_QUESTION);&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msgBox.setText("退出系统");&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msgBox.setMessage("确定退出系统?");&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(msgBox.open()==SWT.YES){&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; }&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">以后使用IWorkbenchWindow的getShell().close();都会调用该处代码.&nbsp;&nbsp;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">四、在RCP中设计界面适合桌面大小&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">final int screenWidth = Display.getCurrent().getBounds().width;<br style="line-height: 22px; padding: 0px; margin: 0px;">final int screenHeight = Display.getCurrent().getBounds().height;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">五、Treeviewer中通过代码，选中树上的某个node节点&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">StructuredSelection sel=new StructuredSelection(node);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;tree.setSelected(sel);&nbsp;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">六、TreeViewer实现双击展开、关闭&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">private class DoubleEventPro implements MouseListener {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void mouseDoubleClick(MouseEvent e) {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TreeItem item = viewer.getTree().getItem(new Point(e.x, e.y));</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (item != null &amp;&amp; item.getItem(0).getText().trim().length() == 0) {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; viewer.expandToLevel(item.getData(), 1);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (item != null &amp;&amp; item.getItemCount() &gt; 0<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; item.getItem(0).getText().trim().length() &gt; 0) {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; item.setExpanded(!item.getExpanded());<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void mouseDown(MouseEvent e) {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void mouseUp(MouseEvent e) {</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">七、 如何屏蔽掉视图窗口上的右键弹出菜单？&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;"></span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><br style="line-height: 22px; padding: 0px; margin: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">方法一：在 postWindowOpen() 中执行下面语句:<br style="line-height: 22px; padding: 0px; margin: 0px;">PlatformUI.getWorkbench().getDisplay().addFilter(SWT.MouseUp, new Listener() {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; public void handleEvent(final Event event) {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(event.widget == your editor &amp;&amp; event.button == 3) {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int hwndCursor = OS.GetCapture ();&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OS.PostMessage(hwndCursor, OS.WM_LBUTTONDOWN, hwndCursor, OS.HTCLIENT | (OS.WM_MOUSEMOVE &lt;&lt; 16));<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">});</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">其它：org.eclipse.ui.internal.presentations.util包中的StandardViewSystemMenu类控制着这些菜单，还没来得急仔细研究，研究过后再补充</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">八、在使用tableviewer的时候导入大量数据的问题</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">创建了一个tableviewer，然后使用setInput方法导入数据，如果数据量很大的话根本就无效率可言了，以下是几种解决的方法：</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">方法一：通过移动滚动条来达到自动加载的目的，在滚动条的事件中加入翻页的代码，可以参考《Eclipse从入门到精通》第二版的P383</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">方法二：分页显示（</span><a style="text-decoration: none; font-size: 1em; font-family: Arial, Helvetica, sans-serif; color: #a07e50; line-height: 22px; padding: 0px; margin: 0px;" href="http://www.eclipseworld.org/bbs/read-cec-tid-11678-keyword-table.html"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">http://www.eclipseworld.org/bbs/read-cec-tid-11678-keyword-table.html</span></a><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">）</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">方法三：使用 Virtual Tables，JFace3.2的Viewer已经支持SWT.VIRTUAL样式<br style="line-height: 22px; padding: 0px; margin: 0px;"></span><a style="text-decoration: none; font-size: 1em; font-family: Arial, Helvetica, sans-serif; color: #a07e50; line-height: 22px; padding: 0px; margin: 0px;" href="http://www.eclipse.org/articles/Article-SWT-Virtual/Virtual-in-SWT.html"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">http://www.eclipse.org/articles/Article-SWT-Virtual/Virtual-in-SWT.html</span></a></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">1 int COUNT = 10000;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">2 final String [] itemStrings = new String [COUNT];&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">3 for (int i = 0; i &lt; COUNT; i++) {&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">4&nbsp;&nbsp; itemStrings = "item " + i;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">5 }&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">6 final Table table = new Table(parent, SWT.BORDER | SWT.VIRTUAL);&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">7 table.addListener(SWT.SetData, new Listener() {&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">8&nbsp;&nbsp; public void handleEvent(Event event) {&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">9&nbsp;&nbsp;&nbsp;&nbsp; TableItem item = (TableItem)event.item;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">10&nbsp;&nbsp;&nbsp;&nbsp; int index = event.index;&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">11&nbsp;&nbsp;&nbsp;&nbsp; item.setText(itemStrings [index]);&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">12&nbsp;&nbsp; }&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">13 });&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">14 table.setItemCount(COUNT);</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">九、在透视图快捷方式栏中同时显示多个透视图快捷方式</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">如果在程序中做了多个个透视图，默认只显示初始透视图快捷方式，每次都要 打开透视图——other，特麻烦，所以，一下提供两种方法：</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">1、在切换栏中显示<br style="line-height: 22px; padding: 0px; margin: 0px;">public class PIMWorkbenchAdvisor extends WorkbenchAdvisor {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; @Override<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; public void postStartup() {<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; super.postStartup();<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IWorkbenchWindow activeWorkbenchWindow = PlatformUI.getWorkbench().getActiveWorkbenchWindow();<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //2007.01.11 设置同时显示多个透视图标<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PerspectiveBarManager barManager=((WorkbenchWindow)activeWorkbenchWindow).getPerspectiveBar();<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(barManager != null){<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPerspectiveDescriptor mailPerspective = WorkbenchPlugin.getDefault().getPerspectiveRegistry&nbsp;&nbsp; ().findPerspectiveWithId("MyWork_mail.perspective");<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PerspectiveBarContributionItem item=new PerspectiveBarContributionItem(mailPerspective,activeWorkbenchWindow.getActivePage());<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; barManager.addItem(item);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">}<br style="line-height: 22px; padding: 0px; margin: 0px;">2、在下拉框中(shortcut)显示<br style="line-height: 22px; padding: 0px; margin: 0px;">public class UiPerspective implements IPerspectiveFactory<br style="line-height: 22px; padding: 0px; margin: 0px;">{<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; public void createInitialLayout(IPageLayout layout){<br style="line-height: 22px; padding: 0px; margin: 0px;">....<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //增加透视图<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; layout.addPerspectiveShortcut("net.sf.pim.plugin.UiPerspective");<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; layout.addPerspectiveShortcut("MyWork_mail.perspective");<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">}<br style="line-height: 22px; padding: 0px; margin: 0px;">十、控制“最近打开文档”的个数<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RCP中在继承ActionBarAdvisor的类中定义:<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private IContributionItem reOpenAction = ContributionItemFactory.REOPEN_EDITORS.create(window);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然后在fillMenuBar(IMenuManager menuBar)方法中添加上面的aciton<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 运行时“最近打开的文档”只有4个，如果想自己控制“最近打开的文档”的数量，则设置一下Workbench中的初始化首选项时RECENT_FILES的默认参数值如：<br style="line-height: 22px; padding: 0px; margin: 0px;">WorkbenchPlugin.getDefault().getPreferenceStore().setDefault(IPreferenceConstants.RECENT_FILES,10);</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">十一、设置Eclipse RCP程序的外观和首选项&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RCP应用程序的缺省外观是一个空白窗口，一般我们要通过一个WorkbenchAdvisor类对界面进行定制。 WorkbenchAdvisor有很多回调方法，可以在preWindowOpen()方法里设置菜单、工具条、状态栏、进度栏、透视图切换工具是否可 见，在fillActionBars()方法里添加菜单和工具条项，在getInitialWindowPerspectiveId()方法里指定首选的 透视图。</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 缺省情况下，透视图切换工具位于窗口左上角，在Eclipse里可以通过Window-&gt;Preferences-&gt; Workbench-&gt;Appearance改变它的位置，那么怎样用程序控制它呢？有两个方法，第一个是使用如下代码设置 IPreferenceStore中的变量：</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">IPreferenceStore apiStore = PrefUtil.getAPIPreferenceStore();&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">apiStore.setValue(IWorkbenchPreferenceConstants.DOCK_PERSPECTIVE_BAR, IWorkbenchPreferenceConstants.TOP_RIGHT);&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">另一个方法是在plugin所在目录建一个名为plugin_customization.ini的文件，里面写如下内容：</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">your.plugin.id/DOCK_PERSPECTIVE_BAR=topRight&nbsp;<br style="line-height: 22px; padding: 0px; margin: 0px;">其他与plugin相关的Preference值可以用同样方法设置。</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">Update:在最新的Eclipse 3.1M5a版本中，对RCP应用程序菜单和工具条的定制方法有所改变，应该使用新加入的ActionBarAdvisor类来完成此项工作。</span></p> 
<p style="margin-top: 0px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; color: #b5b8a5; line-height: 22px; padding: 0px;"><span style="margin: 0px; color: #993366; line-height: 22px; padding: 0px;">十二、获得自己开发的plugin被安装的目录<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp; /** *//**<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp; * @return 本插件的安装路径<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp; */<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; public String getInstallDir() ...{<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (installPath == null) ...{<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; URL localUrl = null;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try ...{<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; localUrl = FileLocator.toFileURL(getDefault().getBundle()<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .getEntry("/"));<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; installPath = localUrl.getFile().substring(1);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (Exception e) ...{<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; log(e);<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return installPath;<br style="line-height: 22px; padding: 0px; margin: 0px;">&nbsp;&nbsp;&nbsp; }</span></p> 
<div>
 <span style="color: #993366;"><br></span>
</div> 
<p></p>