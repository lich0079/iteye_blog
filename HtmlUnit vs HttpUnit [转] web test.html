<p>最有价值的是最后一段，介绍了许多测试工具</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>&nbsp;</p> 
<p>There’s a lot of misinformation out there regarding web application test tools, so I’ve decided to post a series of short articles comparing some of the open source options available here in Java-land, circa 2007. The first of these articles will focus on <a href="http://htmlunit.sourceforge.net/"><span style="color: #1d58d1;">HtmlUnit</span></a> and <a href="http://httpunit.sourceforge.net/"><span style="color: #1d58d1;">HttpUnit</span></a>. Please take my criticism and praise with a grain of salt, as I’m a committer to the HtmlUnit project and thus probably biased. Nevertheless, I will do my best to be objective. I may even overcompensate in the other direction!</p> 
<p><strong>Confusion</strong></p> 
<p>The HtmlUnit and HttpUnit projects are often confused due to the similarity of their names. And the similarity doesn’t end there: they are both open source projects; they are both 100% Java frameworks, rather than drivers for native browsers like IE or Firefox; and they are both fairly mature projects.</p> 
<p>This confusion is compounded by the fact that many test frameworks which once used HttpUnit under the covers have since switched to using HtmlUnit, mainly in order to benefit from its excellent JavaScript support. Examples include <a href="http://jwebunit.sourceforge.net/"><span style="color: #1d58d1;">JWebUnit</span></a>, whose <a href="http://jwebunit.sourceforge.net/faq.html"><span style="color: #1d58d1;">FAQ</span></a> briefly explains the switch, and <a href="http://webtest.canoo.com/webtest/manual/WebTestHome.html"><span style="color: #1d58d1;">Canoo WebTest</span></a>, which <a href="http://lists.canoo.com/pipermail/webtest/2004q2/001658.html"><span style="color: #1d58d1;">switched in 2004</span></a> due to JavaScript support issues and an unresponsive development team [1].</p> 
<p><strong>HttpUnit</strong></p> 
<p>HttpUnit is the granddaddy web app testing framework. Started in the summer of 2000 by Russ Gold [2], it was the first project to focus on this niche area. The project has since <a href="http://sourceforge.net/mailarchive/forum.php?thread_name=554068.87624.qm%40web43136.mail.sp1.yahoo.com&amp;forum_name=httpunit-develop"><span style="color: #1d58d1;">stagnated</span></a> somewhat, with nearly 40% of <a href="http://sourceforge.net/tracker/?group_id=6550&amp;atid=106550"><span style="color: #1d58d1;">bugs</span></a> remaining open, some of them nearly three years old. Its latest maintenance release is about a year and a half old.</p> 
<p>The API is fairly low-level, modeling web interactions at something approaching the HTTP request and response level. The following is a slightly modified example from the <a href="http://httpunit.sourceforge.net/doc/cookbook.html"><span style="color: #1d58d1;">HttpUnit Cookbook</span></a>:</p> 
<pre>WebConversation wc = new WebConversation();
WebResponse resp = wc.getResponse("http://www.google.com/");
WebLink link = resp.getLinkWith("About Google");
link.click();
WebResponse resp2 = wc.getCurrentPage();</pre> 
<p>As you can see, things center around <em>WebConversations</em>, <em>WebRequests</em> and <em>WebResponses</em>. Unfortunately, any page with a decent amount of JavaScript is likely to break HttpUnit, and you can absolutely forget testing any pages which use third party JavaScript libraries.</p> 
<p>Nevertheless, HttpUnit continues to generate 3,000 to 4,000 <a href="http://sourceforge.net/project/stats/detail.php?group_id=6550&amp;ugn=httpunit&amp;type=prdownload&amp;mode=alltime&amp;package_id=0"><span style="color: #1d58d1;">downloads</span></a> per month. A good analogy, if I may be allowed a brief subjective comment, is that HttpUnit is to the web app testing world what Struts is to the web app framework world: there are many “better” options out there, but it just won’t go away! <img class="wp-smiley" alt=";-)" src="http://gredler.wordpress.com/wp-includes/images/smilies/icon_wink.gif"></p> 
<p><strong>HtmlUnit</strong></p> 
<p>HtmlUnit is itself a fairly old project, having been started by <a href="http://www.sphericalimprovement.com/blogs/mbowler/"><span style="color: #1d58d1;">Mike Bowler</span></a> in early 2002. Mike has since ceased active development, but the project currently boasts 3 or 4 active developers and a total of seven <a href="http://www.ohloh.net/projects/3592/analyses/latest/contributors"><span style="color: #1d58d1;">committers</span></a> (whereas HttpUnit remains a <a href="http://www.ohloh.net/projects/393/analyses/latest/contributors"><span style="color: #1d58d1;">one-man show</span></a>). It averages about three <a href="http://htmlunit.sourceforge.net/changes-report.html"><span style="color: #1d58d1;">releases</span></a> per year, and has seen increased developer activity in the past six months or so, especially in the area of JavaScript support.</p> 
<p>HtmlUnit’s API is a bit more high-level than HttpUnit’s, modeling web interaction in terms of the documents and interface elements which the user interacts with:</p> 
<pre>WebClient wc = new WebClient();
HtmlPage page = (HtmlPage) wc.getPage("http://www.google.com");
HtmlForm form = page.getFormByName("f");
HtmlSubmitInput button = (HtmlSubmitInput) form.getInputByName("btnG");
HtmlPage page2 = (HtmlPage) button.click();</pre> 
<p>As you can see, the code centers around <em>WebClients</em>, as well as pages, links, forms, buttons, etc. Pages with a modicum of custom JavaScript will probably work when tested with HtmlUnit. Unfortunately, pages which use third party libraries might or might not work when tested via HtmlUnit. As of the current version, <a href="http://www.prototypejs.org/"><span style="color: #1d58d1;">Prototype</span></a>, <a href="http://mguillem.wordpress.com/2007/08/02/scriptaculous-drag-drop-now-works-for-htmlunit/"><span style="color: #1d58d1;">Script.aculo.us</span></a>, <a href="http://www.nabble.com/Anyone-using-HtmlUnit-with-DWR--t4178601.html"><span style="color: #1d58d1;">DWR</span></a> and <a href="http://daniel.gredler.net/2007/08/08/htmlunit-taming-jquery/"><span style="color: #1d58d1;">jQuery</span></a> are known to be supported fairly well, <a href="http://dojotoolkit.org/"><span style="color: #1d58d1;">Dojo</span></a> is a bit of an unknown, <a href="http://developer.yahoo.com/yui/"><span style="color: #1d58d1;">YUI</span></a> is known to be unsupported, and <a href="http://www.nabble.com/HtmlUnit-%2B-GWT-tf4267332.html#a12144641"><span style="color: #1d58d1;">GWT</span></a> is known to work with fairly simple applications. Most of this compatibility has been achieved in the past two or three releases, so obviously things are fairly fluid.</p> 
<p><strong>Conclusion</strong></p> 
<p>If you’re using HttpUnit for legacy reasons, it’s a fairly solid package, but don’t expect to get much support when you need to report a bug or submit a patch for a new feature. If you’re starting a new project and are trying to decide between these two frameworks, HtmlUnit wins hands down. It has the features, the community and the momentum.</p> 
<p>Of course, if you’re considering web application testing tools, you’re probably looking at more than just these two options. <a href="http://webtest.canoo.com/webtest/manual/WebTestHome.html"><span style="color: #1d58d1;">Canoo WebTest</span></a>, <a href="http://www.pushtotest.com/"><span style="color: #1d58d1;">TestMaker</span></a>, <a href="http://jwebunit.sourceforge.net/"><span style="color: #1d58d1;">JWebUnit</span></a>, <a href="http://www.openqa.org/selenium/"><span style="color: #1d58d1;">Selenium</span></a>, <a href="http://code.google.com/p/webdriver/"><span style="color: #1d58d1;">WebDriver</span></a> and <a href="http://jakarta.apache.org/jmeter/"><span style="color: #1d58d1;">JMeter</span></a> are all likely to be on your list. Depending on your project budget and requirements, <a href="http://squish.froglogic.com/"><span style="color: #1d58d1;">Squish</span></a> and <a href="http://www.mercury.com/us/products/quality-center/functional-testing/quicktest-professional/"><span style="color: #1d58d1;">Mercury QTP</span></a> may also be under consideration. If that’s the case, stay tuned, because I intend to post a series of web app testing framework comparisons in the coming months — all of them involving HtmlUnit, of course!</p> 
<p>[1] It’s interesting to note that both Marc Guillemot and I (two HtmlUnit committers) began by using HttpUnit, submitting patches for missing features — but settled on HtmlUnit when the patches were not applied in a timely manner.</p> 
<p>[2] The HttpUnit website states that <a href="http://httpunit.sourceforge.net/doc/developers.html"><span style="color: #1d58d1;">Russ currently works for Oracle</span></a>, developing the OC4J application server. Coincidentally, this is the production application server we’re using at my day job. Thanks, Russ! <br></p> 
<p class="poweredbyperformancing">Powered by <a href="http://scribefire.com/"><span style="color: #1d58d1;">ScribeFire</span></a>.</p>