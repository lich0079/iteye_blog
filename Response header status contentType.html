<p><strong>文件下载，指定默认名</strong><a href="http://hi.baidu.com/srxljl" style="font-size: 1px; text-decoration: none;"><span style="color: #810081;">srxljl</span></a><br>Response.AddHeader("content-type","application/x-msdownload");<br>Response.AddHeader("Content-Disposition","attachment;filename=要下载的文件名.rar");<br><br><strong>刷新页面</strong><a href="http://hi.baidu.com/srxljl" style="font-size: 1px; text-decoration: none;"><span style="color: #810081;">srxljl</span></a><br>Response.AddHeader “REFRESH”, ”60;URL=newpath/newpage.asp” <br>这等同于客户机端&lt;META&gt;元素： <br>&lt;META HTTP-EQUIV=”REFRESH”, “60;URL=newpath/newpage.asp” </p> 
<p><strong>页面转向</strong><a href="http://hi.baidu.com/srxljl" style="font-size: 1px; text-decoration: none;"><span style="color: #810081;">srxljl</span></a><br>Response.Status = “302 Object Moved” <br>Response.Addheader “Location”, “newpath/newpage.asp” <br>这等同于使用Response.Redirect方法： <br>Response.Redirect “newpath/newpage.asp” </p> 
<p><strong>强制浏览器显示一个用户名/口令对话框</strong><a href="http://hi.baidu.com/srxljl" style="font-size: 1px; text-decoration: none;"><span style="color: #810081;">srxljl</span></a><br>Response.Status= “401 Unauthorized” <br>Response.Addheader “WWW-Authenticate”, “BASIC” <br>强制浏览器显示一个用户名/口令对话框，然后使用BASIC验证把它们发送回服务器（将在本书后续部分看到验证方法）。<br><br><strong>如何让网页不缓冲</strong><a href="http://hi.baidu.com/srxljl" style="font-size: 1px; text-decoration: none;"><span style="color: #810081;">srxljl</span></a><br>Response.Expires = 0 <br>Response.ExpiresAbsolute = Now() - 1 <br>Response.Addheader "pragma","no-cache" <br>Response.Addheader "cache-control","private" <br>Response.CacheControl = "no-cache</p> 
<p><br><br><br><br><br>应用实例：文件下载<br><br><strong>做下载中文显示乱码怎么办</strong><a href="http://hi.baidu.com/srxljl" style="font-size: 1px; text-decoration: none;"><span style="color: #810081;">srxljl</span></a><br><br>在网站上文件下载都是直接点击文件联接就行了，这种方法有几个弊端:<br>1. 有些文件不会下载会直接调用相应的程序打开该文件<br>2。不能隐藏实际文件地址。<br>3。不能够从数据库中动态读取文件名进行改名下载</p> 
<p>下面是asp.net,c#代码:<br>string fileName;//文件在数据库中的名称<br>string dir ;//文件在服务器的物理路径(如c:\aa\ddd\wj0000222.zdo)<br>long size ;//文件的大小<br>Response.AddHeader("content-type", "application/x-msdownload;");<br>Response.AddHeader("Content-Disposition","attachment;filename="+fileName[自己定义的]);<br>Response.AddHeader("content-length", size.ToString());<br>Response.WriteFile(dir,0,size);</p> 
<p>这种方法可以实现以上的目的，但是当文件名（fileName）为中文时在ie下载端显示的是乱码，有谁知道怎么解决。</p> 
<p>我来做个总结吧&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其实楼上的方法是可行的，但有局限性&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 关键在于UrlEncode这个东东，在下面不同情况下的结果是不一样的&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1。web.config&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 里responseEncoding="gb2312"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2。web.config&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 里responseEncoding="utf-8"&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使用Server.UrlEncode的话必须responseEncoding="utf-8"才会正确&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 所以不要用Server.UrlEncode，换HttpUtility.UrlEncode&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s=HttpUtility.UrlEncode(System.Text.UTF8Encoding.UTF8.GetBytes("中文.txt"));&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.AppendHeader("Content-Disposition",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "attachment;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filename="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s);&nbsp;&nbsp;&nbsp;</p> 
<p>&nbsp;</p> 
<p>百度相关搜索：<a href="http://www.baidu.com/s?wd=response%2Eaddheader&amp;lm=0&amp;si=&amp;rn=10&amp;ie=gb2312&amp;ct=0&amp;cl=3&amp;f=1&amp;rsp=0">response.addheader</a> <a href="http://www.baidu.com/s?wd=%D6%D0%CE%C4%C2%D2%C2%EB&amp;lm=0&amp;si=&amp;rn=10&amp;ie=gb2312&amp;ct=0&amp;cl=3&amp;f=1&amp;rsp=2">中文乱码</a> <br><br>参考资料：<br><a href="http://topic.csdn.net/t/20040401/06/2911166.html" target="_blank"><span style="font-size: small;"><span style="color: #c60a00;">中文</span><span style="color: #810081;">显示</span><span style="color: #c60a00;">乱码</span><span style="color: #810081;">怎么办？</span><span style="color: #c60a00;">Response.AddHeader</span><span style="color: #810081;">("Content-Disposition",..</span></span></a>(<a href="http://www.baidu.com/s?lm=0&amp;si=&amp;rn=10&amp;ie=gb2312&amp;ct=0&amp;wd=response%2EaddHeader%28%29+%D6%D0%CE%C4%C2%D2%C2%EB%20site%3Atopic%2Ecsdn%2Enet+&amp;cl=2" class="m" target="_blank"><span style="font-size: x-small; color: #666666;">topic.csdn.net 上的更多结果</span></a>)</p> 
<p>&nbsp;</p> 
<p>Web文件的ContentType类型大全.txt</p> 
<p>Response.AddHeader("content-type", "application/x-msdownload;");类型列表</p> 
<p>".*"="application/octet-stream"<br>".001"="application/x-001"<br>".301"="application/x-301"<br>".323"="text/h323"<br>".906"="application/x-906"<br>".907"="drawing/907"<br>".a11"="application/x-a11"<br>".acp"="audio/x-mei-aac"<br>".ai"="application/postscript"<br>".aif"="audio/aiff"<br>".aifc"="audio/aiff"<br>".aiff"="audio/aiff"<br>".anv"="application/x-anv"<br>".asa"="text/asa"<br>".asf"="video/x-ms-asf"<br>".asp"="text/asp"<br>".asx"="video/x-ms-asf"<br>".au"="audio/basic"<br>".avi"="video/avi"<br>".awf"="application/vnd.adobe.workflow"<br>".biz"="text/xml"<br>".bmp"="application/x-bmp"<br>".bot"="application/x-bot"<br>".c4t"="application/x-c4t"<br>".c90"="application/x-c90"<br>".cal"="application/x-cals"<br>".cat"="application/vnd.ms-pki.seccat"<br>".cdf"="application/x-netcdf"<br>".cdr"="application/x-cdr"<br>".cel"="application/x-cel"<br>".cer"="application/x-x509-ca-cert"<br>".cg4"="application/x-g4"<br>".cgm"="application/x-cgm"<br>".cit"="application/x-cit"<br>".class"="java/*"<br>".cml"="text/xml"<br>".cmp"="application/x-cmp"<br>".cmx"="application/x-cmx"<br>".cot"="application/x-cot"<br>".crl"="application/pkix-crl"<br>".crt"="application/x-x509-ca-cert"<br>".csi"="application/x-csi"<br>".css"="text/css"<br>".cut"="application/x-cut"<br>".dbf"="application/x-dbf"<br>".dbm"="application/x-dbm"<br>".dbx"="application/x-dbx"<br>".dcd"="text/xml"<br>".dcx"="application/x-dcx"<br>".der"="application/x-x509-ca-cert"<br>".dgn"="application/x-dgn"<br>".dib"="application/x-dib"<br>".dll"="application/x-msdownload"<br>".doc"="application/msword"<br>".dot"="application/msword"<br>".drw"="application/x-drw"<br>".dtd"="text/xml"<br>".dwf"="Model/vnd.dwf"<br>".dwf"="application/x-dwf"<br>".dwg"="application/x-dwg"<br>".dxb"="application/x-dxb"<br>".dxf"="application/x-dxf"<br>".edn"="application/vnd.adobe.edn"<br>".emf"="application/x-emf"<br>".eml"="message/rfc822"<br>".ent"="text/xml"<br>".epi"="application/x-epi"<br>".eps"="application/x-ps"<br>".eps"="application/postscript"<br>".etd"="application/x-ebx"<br>".exe"="application/x-msdownload"<br>".fax"="image/fax"<br>".fdf"="application/vnd.fdf"<br>".fif"="application/fractals"<br>".fo"="text/xml"<br>".frm"="application/x-frm"<br>".g4"="application/x-g4"<br>".gbr"="application/x-gbr"<br>".gcd"="application/x-gcd"<br>".gif"="image/gif"<br>".gl2"="application/x-gl2"<br>".gp4"="application/x-gp4"<br>".hgl"="application/x-hgl"<br>".hmr"="application/x-hmr"<br>".hpg"="application/x-hpgl"<br>".hpl"="application/x-hpl"<br>".hqx"="application/mac-binhex40"<br>".hrf"="application/x-hrf"<br>".hta"="application/hta"<br>".htc"="text/x-component"<br>".htm"="text/html"<br>".html"="text/html"<br>".htt"="text/webviewhtml"<br>".htx"="text/html"<br>".icb"="application/x-icb"<br>".ico"="image/x-icon"<br>".ico"="application/x-ico"<br>".iff"="application/x-iff"<br>".ig4"="application/x-g4"<br>".igs"="application/x-igs"<br>".iii"="application/x-iphone"<br>".img"="application/x-img"<br>".ins"="application/x-internet-signup"<br>".isp"="application/x-internet-signup"<br>".IVF"="video/x-ivf"<br>".java"="java/*"<br>".jfif"="image/jpeg"<br>".jpe"="image/jpeg"<br>".jpe"="application/x-jpe"<br>".jpeg"="image/jpeg"<br>".jpg"="image/jpeg"<br>".jpg"="application/x-jpg"<br>".js"="application/x-javascript"<br>".jsp"="text/html"<br>".la1"="audio/x-liquid-file"<br>".lar"="application/x-laplayer-reg"<br>".latex"="application/x-latex"<br>".lavs"="audio/x-liquid-secure"<br>".lbm"="application/x-lbm"<br>".lmsff"="audio/x-la-lms"<br>".ls"="application/x-javascript"<br>".ltr"="application/x-ltr"<br>".m1v"="video/x-mpeg"<br>".m2v"="video/x-mpeg"<br>".m3u"="audio/mpegurl"<br>".m4e"="video/mpeg4"<br>".mac"="application/x-mac"<br>".man"="application/x-troff-man"<br>".math"="text/xml"<br>".mdb"="application/msaccess"<br>".mdb"="application/x-mdb"<br>".mfp"="application/x-shockwave-flash"<br>".mht"="message/rfc822"<br>".mhtml"="message/rfc822"<br>".mi"="application/x-mi"<br>".mid"="audio/mid"<br>".midi"="audio/mid"<br>".mil"="application/x-mil"<br>".mml"="text/xml"<br>".mnd"="audio/x-musicnet-download"<br>".mns"="audio/x-musicnet-stream"<br>".mocha"="application/x-javascript"<br>".movie"="video/x-sgi-movie"<br>".mp1"="audio/mp1"<br>".mp2"="audio/mp2"<br>".mp2v"="video/mpeg"<br>".mp3"="audio/mp3"<br>".mp4"="video/mpeg4"<br>".mpa"="video/x-mpg"<br>".mpd"="application/vnd.ms-project"<br>".mpe"="video/x-mpeg"<br>".mpeg"="video/mpg"<br>".mpg"="video/mpg"<br>".mpga"="audio/rn-mpeg"<br>".mpp"="application/vnd.ms-project"<br>".mps"="video/x-mpeg"<br>".mpt"="application/vnd.ms-project"<br>".mpv"="video/mpg"<br>".mpv2"="video/mpeg"<br>".mpw"="application/vnd.ms-project"<br>".mpx"="application/vnd.ms-project"<br>".mtx"="text/xml"<br>".mxp"="application/x-mmxp"<br>".net"="image/pnetvue"<br>".nrf"="application/x-nrf"<br>".nws"="message/rfc822"<br>".odc"="text/x-ms-odc"<br>".out"="application/x-out"<br>".p10"="application/pkcs10"<br>".p12"="application/x-pkcs12"<br>".p7b"="application/x-pkcs7-certificates"<br>".p7c"="application/pkcs7-mime"<br>".p7m"="application/pkcs7-mime"<br>".p7r"="application/x-pkcs7-certreqresp"<br>".p7s"="application/pkcs7-signature"<br>".pc5"="application/x-pc5"<br>".pci"="application/x-pci"<br>".pcl"="application/x-pcl"<br>".pcx"="application/x-pcx"<br>".pdf"="application/pdf"<br>".pdf"="application/pdf"<br>".pdx"="application/vnd.adobe.pdx"<br>".pfx"="application/x-pkcs12"<br>".pgl"="application/x-pgl"<br>".pic"="application/x-pic"<br>".pko"="application/vnd.ms-pki.pko"<br>".pl"="application/x-perl"<br>".plg"="text/html"<br>".pls"="audio/scpls"<br>".plt"="application/x-plt"<br>".png"="image/png"<br>".png"="application/x-png"<br>".pot"="application/vnd.ms-powerpoint"<br>".ppa"="application/vnd.ms-powerpoint"<br>".ppm"="application/x-ppm"<br>".pps"="application/vnd.ms-powerpoint"<br>".ppt"="application/vnd.ms-powerpoint"<br>".ppt"="application/x-ppt"<br>".pr"="application/x-pr"<br>".prf"="application/pics-rules"<br>".prn"="application/x-prn"<br>".prt"="application/x-prt"<br>".ps"="application/x-ps"<br>".ps"="application/postscript"<br>".ptn"="application/x-ptn"<br>".pwz"="application/vnd.ms-powerpoint"<br>".r3t"="text/vnd.rn-realtext3d"<br>".ra"="audio/vnd.rn-realaudio"<br>".ram"="audio/x-pn-realaudio"<br>".ras"="application/x-ras"<br>".rat"="application/rat-file"<br>".rdf"="text/xml"<br>".rec"="application/vnd.rn-recording"<br>".red"="application/x-red"<br>".rgb"="application/x-rgb"<br>".rjs"="application/vnd.rn-realsystem-rjs"<br>".rjt"="application/vnd.rn-realsystem-rjt"<br>".rlc"="application/x-rlc"<br>".rle"="application/x-rle"<br>".rm"="application/vnd.rn-realmedia"<br>".rmf"="application/vnd.adobe.rmf"<br>".rmi"="audio/mid"<br>".rmj"="application/vnd.rn-realsystem-rmj"<br>".rmm"="audio/x-pn-realaudio"<br>".rmp"="application/vnd.rn-rn_music_package"<br>".rms"="application/vnd.rn-realmedia-secure"<br>".rmvb"="application/vnd.rn-realmedia-vbr"<br>".rmx"="application/vnd.rn-realsystem-rmx"<br>".rnx"="application/vnd.rn-realplayer"<br>".rp"="image/vnd.rn-realpix"<br>".rpm"="audio/x-pn-realaudio-plugin"<br>".rsml"="application/vnd.rn-rsml"<br>".rt"="text/vnd.rn-realtext"<br>".rtf"="application/msword"<br>".rtf"="application/x-rtf"<br>".rv"="video/vnd.rn-realvideo"<br>".sam"="application/x-sam"<br>".sat"="application/x-sat"<br>".sdp"="application/sdp"<br>".sdw"="application/x-sdw"<br>".sit"="application/x-stuffit"<br>".slb"="application/x-slb"<br>".sld"="application/x-sld"<br>".slk"="drawing/x-slk"<br>".smi"="application/smil"<br>".smil"="application/smil"<br>".smk"="application/x-smk"<br>".snd"="audio/basic"<br>".sol"="text/plain"<br>".sor"="text/plain"<br>".spc"="application/x-pkcs7-certificates"<br>".spl"="application/futuresplash"<br>".spp"="text/xml"<br>".ssm"="application/streamingmedia"<br>".sst"="application/vnd.ms-pki.certstore"<br>".stl"="application/vnd.ms-pki.stl"<br>".stm"="text/html"<br>".sty"="application/x-sty"<br>".svg"="text/xml"<br>".swf"="application/x-shockwave-flash"<br>".tdf"="application/x-tdf"<br>".tg4"="application/x-tg4"<br>".tga"="application/x-tga"<br>".tif"="image/tiff"<br>".tif"="application/x-tif"<br>".tiff"="image/tiff"<br>".tld"="text/xml"<br>".top"="drawing/x-top"<br>".torrent"="application/x-bittorrent"<br>".tsd"="text/xml"<br>".txt"="text/plain"<br>".uin"="application/x-icq"<br>".uls"="text/iuls"<br>".vcf"="text/x-vcard"<br>".vda"="application/x-vda"<br>".vdx"="application/vnd.visio"<br>".vml"="text/xml"<br>".vpg"="application/x-vpeg005"<br>".vsd"="application/vnd.visio"<br>".vsd"="application/x-vsd"<br>".vss"="application/vnd.visio"<br>".vst"="application/vnd.visio"<br>".vst"="application/x-vst"<br>".vsw"="application/vnd.visio"<br>".vsx"="application/vnd.visio"<br>".vtx"="application/vnd.visio"<br>".vxml"="text/xml"<br>".wav"="audio/wav"<br>".wax"="audio/x-ms-wax"<br>".wb1"="application/x-wb1"<br>".wb2"="application/x-wb2"<br>".wb3"="application/x-wb3"<br>".wbmp"="image/vnd.wap.wbmp"<br>".wiz"="application/msword"<br>".wk3"="application/x-wk3"<br>".wk4"="application/x-wk4"<br>".wkq"="application/x-wkq"<br>".wks"="application/x-wks"<br>".wm"="video/x-ms-wm"<br>".wma"="audio/x-ms-wma"<br>".wmd"="application/x-ms-wmd"<br>".wmf"="application/x-wmf"<br>".wml"="text/vnd.wap.wml"<br>".wmv"="video/x-ms-wmv"<br>".wmx"="video/x-ms-wmx"<br>".wmz"="application/x-ms-wmz"<br>".wp6"="application/x-wp6"<br>".wpd"="application/x-wpd"<br>".wpg"="application/x-wpg"<br>".wpl"="application/vnd.ms-wpl"<br>".wq1"="application/x-wq1"<br>".wr1"="application/x-wr1"<br>".wri"="application/x-wri"<br>".wrk"="application/x-wrk"<br>".ws"="application/x-ws"<br>".ws2"="application/x-ws"<br>".wsc"="text/scriptlet"<br>".wsdl"="text/xml"<br>".wvx"="video/x-ms-wvx"<br>".xdp"="application/vnd.adobe.xdp"<br>".xdr"="text/xml"<br>".xfd"="application/vnd.adobe.xfd"<br>".xfdf"="application/vnd.adobe.xfdf"<br>".xhtml"="text/html"<br>".xls"="application/vnd.ms-excel"<br>".xls"="application/x-xls"<br>".xlw"="application/x-xlw"<br>".xml"="text/xml"<br>".xpl"="audio/scpls"<br>".xq"="text/xml"<br>".xql"="text/xml"<br>".xquery"="text/xml"<br>".xsd"="text/xml"<br>".xsl"="text/xml"<br>".xslt"="text/xml"<br>".xwd"="application/x-xwd"<br>".x_b"="application/x-x_b"<br>".x_t"="application/x-x_t" </p>